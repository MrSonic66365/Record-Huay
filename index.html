<!DOCTYPE html>
<html>

<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏ß‡∏¢‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</title>

  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; }
    h2 { text-align: center; }
    .form-group { margin: 10px 0; }
    label { display: block; margin-bottom: 5px; }
    input { padding: 5px; width: 100%; }
    button { margin: 5px; padding: 8px 15px; cursor: pointer; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #333; color: white; }
    tr.duplicate { background-color: #f8d7da; } /* ‡πÅ‡∏î‡∏á‡∏≠‡πà‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏Ç‡∏ã‡πâ‡∏≥ */
  </style>

  
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <h2>üìí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏ß‡∏¢‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h2>

  <div class="form-group">
    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</label>
    <input type="text" id="customerName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">
  </div>

  <div class="form-group">
    <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠:</label>
    <input type="text" id="number" placeholder="‡πÄ‡∏ä‡πà‡∏ô 45">
  </div>

  <div class="form-group">
    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô:</label>
    <input type="number" id="amount" placeholder="‡πÄ‡∏ä‡πà‡∏ô 100">
  </div>

  <button onclick="addLotto()">‚ûï ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
  <button onclick="clearAll()">üóë ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
  <button onclick="exportExcel()">‚¨á Export Excel</button>

  <table id="lottoTable">
    <thead>
      <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
        <th>‡πÄ‡∏•‡∏Ç</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
        <th>‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤</th>
        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let lottoData = JSON.parse(localStorage.getItem("lottoData")) || [];

    function saveData() {
      localStorage.setItem("lottoData", JSON.stringify(lottoData));
    }

    function renderTable() {
      const tbody = document.querySelector("#lottoTable tbody");
      tbody.innerHTML = "";
      lottoData.forEach((item, index) => {
        let tr = document.createElement("tr");

        // ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏Ç‡∏ã‡πâ‡∏≥
        let isDuplicate = lottoData.some((d, i) => i !== index && d.number === item.number);
        if (isDuplicate) tr.classList.add("duplicate");

        tr.innerHTML = `
          <td>${item.customer}</td>
          <td>${item.number}</td>
          <td>${item.amount}</td>
          <td>${item.date}</td>
          <td><button onclick="deleteRow(${index})">‚ùå ‡∏•‡∏ö</button></td>
        `;
        tbody.appendChild(tr);
      });
    }

    function addLotto() {
      const customer = document.getElementById("customerName").value.trim();
      const number = document.getElementById("number").value.trim();
      const amount = document.getElementById("amount").value.trim();

      if (!customer || !number || !amount) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
        return;
      }

      const now = new Date();
      const dateStr = now.toLocaleDateString("th-TH") + " " + now.toLocaleTimeString("th-TH");

      lottoData.push({ customer, number, amount, date: dateStr });
      saveData();
      renderTable();

      document.getElementById("customerName").value = "";
      document.getElementById("number").value = "";
      document.getElementById("amount").value = "";
    }

    function deleteRow(index) {
      lottoData.splice(index, 1);
      saveData();
      renderTable();
    }

    function clearAll() {
      if (confirm("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) {
        lottoData = [];
        saveData();
        renderTable();
      }
    }

    function exportExcel() {
      if (lottoData.length === 0) {
        alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å");
        return;
      }
      const worksheet = XLSX.utils.json_to_sheet(lottoData);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "LottoData");
      XLSX.writeFile(workbook, "lottoData.xlsx");
    }

    renderTable();
  </script>
</body>
</html>
