<!DOCTYPE html>
<html>

<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏ß‡∏¢‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</title>

  <style>
    body { font-family: "Tahoma"; padding: 20px; background: #f9f9f9; }
    h2 { color: #333; }
    input, button { padding: 5px; margin: 5px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #eee; }
    tr.duplicate td { background: #ffdddd; } /* ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏Ç‡∏ã‡πâ‡∏≥ */
    #total { margin-top: 15px; font-weight: bold; font-size: 16px; }
  </style>

  
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <h2>üìë ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏ß‡∏¢‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h2>

  <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: <input type="text" id="customer"></label>
  <label>‡πÄ‡∏•‡∏Ç: <input type="text" id="number" maxlength="2"></label>
  <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: <input type="number" id="amount"></label>
  <button onclick="addLotto()">‚ûï ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
  <button onclick="exportExcel()">üì§ Export Excel</button>
  <button onclick="clearAll()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>

  <table id="lottoTable">
    <thead>
      <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
        <th>‡πÄ‡∏•‡∏Ç</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
        <th>‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤</th>
        <th>‡∏•‡∏ö</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div id="total">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: 0 ‡∏ö‡∏≤‡∏ó</div>

  <script>
    let lottoData = JSON.parse(localStorage.getItem("lottoData")) || [];

  function renderTable() {
    const tbody = document.querySelector("#lottoTable tbody");
    tbody.innerHTML = "";
    let total = 0;

    lottoData.forEach((item, index) => {
      const tr = document.createElement("tr");

      // ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏Ç‡∏ã‡πâ‡∏≥
      const isDuplicate = lottoData.some((d, i) => d.number === item.number && i !== index);
      if (isDuplicate) tr.classList.add("duplicate");

      tr.innerHTML = `
        <td>${item.customer}</td>
        <td>${item.number}</td>
        <td>${item.amount}</td>
        <td>${item.date}</td>
        <td><button onclick="deleteRow(${index})">‚ùå</button></td>
      `;
      tbody.appendChild(tr);

      total += parseFloat(item.amount);
    });

    document.getElementById("total").innerText = "‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: " + total.toLocaleString() + " ‡∏ö‡∏≤‡∏ó";
  }

  function addLotto() {
    const customer = document.getElementById("customer").value.trim();
    const number = document.getElementById("number").value.trim();
    const amount = parseFloat(document.getElementById("amount").value);

    if (!customer || !number || isNaN(amount)) {
      alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
      return;
    }

    const now = new Date();
    const date = now.toLocaleString("th-TH");

    lottoData.push({ customer, number, amount, date });
    localStorage.setItem("lottoData", JSON.stringify(lottoData));

    document.getElementById("customer").value = "";
    document.getElementById("number").value = "";
    document.getElementById("amount").value = "";

    renderTable();
  }

  function deleteRow(index) {
    lottoData.splice(index, 1);
    localStorage.setItem("lottoData", JSON.stringify(lottoData));
    renderTable();
  }

  function clearAll() {
    if (confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) {
      lottoData = [];
      localStorage.removeItem("lottoData");
      renderTable();
    }
  }

  function exportExcel() {
    if (lottoData.length === 0) {
      alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å");
      return;
    }
    const ws = XLSX.utils.json_to_sheet(lottoData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Lotto Data");
    XLSX.writeFile(wb, "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏ß‡∏¢.xlsx");
  }

  renderTable();
  </script>
</body>
</html>
